{"version":3,"file":"index.js","sources":["../src/components/DataViewer.js","../src/components/DataEditor.js"],"sourcesContent":["/*\r\n * Copyright © 2019, SAS Institute Inc., Cary, NC, USA.  All Rights Reserved.\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport React, {useState, Fragment} from 'react';\r\nimport {cellEdit, updateTableRows, scrollTable} from '@sassoftware/restafedit';\r\nimport PropTypes from 'prop-types';\r\n\r\nfunction DataViewer (props) {\r\n    const {appEnv, render}   = props;\r\n    const [modFlag, setModFlag] = useState(true);\r\n    const [status, setStatus] = useState(null);\r\n\r\n    const _handleErrors = (err) => {\r\n        setStatus({status: 2, msg: err});\r\n    };\r\n\r\n    // scroll based on pagination data from previous fetch\r\n    const _onScroll = (direction) => {\r\n        scrollTable (direction, appEnv) \r\n            .then (r => {\r\n                setModFlag(!modFlag); \r\n                setStatus({status: 0, msg: null});\r\n            })\r\n            .catch(err => {\r\n                _handleErrors(err);\r\n            });\r\n    };\r\n\r\n    const _onEdit = (name, value, rowIndex, data) => {\r\n        cellEdit (name, value, rowIndex, data, appEnv)\r\n         .then (r => {\r\n            setModFlag(!modFlag); \r\n            setStatus(null);\r\n         })\r\n         .catch(err => {\r\n            _handleErrors(err);\r\n            setStatus(err);\r\n        });\r\n         \r\n    };\r\n\r\n    // Save only modified rows\r\n    // TBD: propagate messages to UI app\r\n    const _onSave = (result) => {\r\n        updateTableRows(result, appEnv)\r\n            .then((r) => {\r\n                setStatus({status: 0, msg: r});\r\n            })\r\n            .catch((err) => setStatus({status: 2, msg: err}));\r\n    };\r\n    debugger;\r\n    //const V = appEnv.appControl.appData.getViewer(appEnv.appControl.appData);\r\n    debugger;\r\n    return (\r\n        <Fragment>\r\n            {props.render(_onEdit,_onScroll,_onSave,status,appEnv)}\r\n        </Fragment>\r\n        );\r\n}\r\nDataViewer.propTypes = {\r\n    /** Application control */\r\n    appEnv: PropTypes.object.isRequired,\r\n    /** user's component for editing     */\r\n    render: PropTypes.func.isRequired\r\n\r\n};\r\nexport default DataViewer;\r\n","/* eslint-disable no-throw-literal */\r\n/*\r\n * Copyright © 2021, SAS Institute Inc., Cary, NC, USA.  All Rights Reserved.\r\n * SPDX-License-Identifier: Apache-2.0\r\n */\r\n\r\nimport React, { useEffect, useState} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {setup, scrollTable} from '@sassoftware/restafedit';\r\nimport DataViewer from './DataViewer';\r\n\r\nfunction DataEditor (props) {\r\n    debugger;\r\n    const { viyaConnection, appControl} = props;\r\n    const [state, setState] = useState({});\r\n\r\n    //\r\n    // Keeping it simple - convert to suspense, lazy etc at some point\r\n    //\r\n    const initialize = async () => {\r\n        debugger;\r\n        let r = await setup(viyaConnection, appControl);\r\n        await scrollTable('first', r);\r\n        return r;\r\n    };\r\n\r\n    useEffect(() => {\r\n        initialize()\r\n            .then((r) => {\r\n                setState(r);\r\n            })\r\n            .catch((err) => {\r\n                throw new Error (JSON.stringify(err));\r\n            });\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    let show = null;\r\n    if (state.session != null) {\r\n        show =\r\n            <div id=\"page-wrap\" key={Date()}>\r\n                <DataViewer appEnv={state} \r\n                render ={props.render} />\r\n            </div>;\r\n    }\r\n    return show;\r\n}\r\nDataEditor.propTypes = {\r\n    /** Information to setup connection to Viya */\r\n    viyaConnection: PropTypes.object.isRequired,\r\n\r\n    /** Information to setup application */\r\n    appControl: PropTypes.object.isRequired,\r\n\r\n    /** user's component for editing     */\r\n    render: PropTypes.func.isRequired\r\n\r\n};\r\nexport default DataEditor;\r\n"],"names":["props","appEnv","_useState","useState","modFlag","setModFlag","_useState2","setStatus","err","status","msg","React","createElement","Fragment","render","name","value","rowIndex","data","cellEdit","then","r","catch","_handleErrors","direction","scrollTable","result","updateTableRows","viyaConnection","appControl","state","setState","useEffect","setup","Promise","resolve","e","reject","initialize","Error","JSON","stringify","session","show","id","key","Date","DataViewer","propTypes","PropTypes","object","isRequired","func","DataEditor"],"mappings":"wMASA,WAAqBA,GACVC,IAAPA,EAA2BD,EAApBC,OACPC,EAA8BC,EAAQA,UAAC,GAAhCC,EAASC,EAAAA,GAAAA,EAChBH,EAAA,GAAAI,EAA4BH,EAAQA,SAAC,MAAtBI,EAEfD,EAAA,KAAsB,SAACE,GACnBD,EAAU,CAACE,OAAQ,EAAGC,IAAKF,GAC9B,eAuCD,OACIG,EAAAA,QAACC,cAAAC,EAADA,cACKb,EAAMc,OA3BC,SAACC,EAAMC,EAAOC,EAAUC,GACpCC,WAAUJ,EAAMC,EAAOC,EAAUC,EAAMjB,GACrCmB,KAAM,SAAAC,GACJhB,GAAYD,GACZG,EAAU,KACZ,GACAe,MAAM,SAAAd,GACJe,EAAcf,GACdD,EAAUC,EACb,EAEJ,EAtBiB,SAACgB,GACfC,EAAWA,YAAED,EAAWvB,GACnBmB,KAAM,SAAAC,GACHhB,GAAYD,GACZG,EAAU,CAACE,OAAQ,EAAGC,IAAK,MAC9B,GACAY,MAAM,SAAAd,GACHe,EAAcf,EACjB,EACR,EAiBe,SAACkB,GACbC,EAAAA,gBAAgBD,EAAQzB,GACnBmB,KAAK,SAACC,GACHd,EAAU,CAACE,OAAQ,EAAGC,IAAKW,GAC9B,GACAC,MAAM,SAACd,GAAQD,OAAAA,EAAU,CAACE,OAAQ,EAAGC,IAAKF,GAApC,EACd,EAvCcD,EAAAA,GA6CwCN,GAG1D,CCjDD,WAAqBD,GAEjB,IAAQ4B,EAA8B5B,EAA9B4B,eAAgBC,EAAc7B,EAAd6B,WACE1B,EAAAA,EAAAA,SAAS,CAAA,GAA5B2B,OAAOC,EAAd7B,EAAA,GAYA8B,EAAAA,UAAU,YAPM,WAAe,IAAA,OAEbC,QAAAA,QAAAA,EAAAA,MAAML,EAAgBC,IAFTT,KAAA,SAEvBC,GAFuB,OAAAa,QAAAC,QAGrBV,EAAWA,YAAC,QAASJ,IAC3BD,KAAA,WAAA,QAJ2B,EAK9B,EALD,CAAgB,MAAhBgB,GAAA,OAAAF,QAAAG,OAAAD,EAAA,CAAA,EAQIE,GACKlB,KAAK,SAACC,GACHU,EAASV,EACZ,GACAC,MAAM,SAACd,GACJ,MAAU+B,IAAAA,MAAOC,KAAKC,UAAUjC,GACnC,EAER,EAAE,IAEH,MAAW,KAQX,OAPqB,MAAjBsB,EAAMY,UACNC,eACIhC,EAAK,QAAAC,cAAA,MAAA,CAAAgC,GAAG,YAAYC,IAAKC,qBACrBnC,EAAC,QAAAC,cAAAmC,GAAW9C,OAAQ6B,EACpBhB,OAASd,EAAMc,WAI9B6B,CAAA,CDeDI,EAAWC,UAAY,CAEnB/C,OAAQgD,EAAS,QAACC,OAAOC,WAEzBrC,OAAQmC,EAAS,QAACG,KAAKD,YClB3BE,EAAWL,UAAY,CAEnBpB,eAAgBqB,EAAS,QAACC,OAAOC,WAGjCtB,WAAYoB,UAAUC,OAAOC,WAG7BrC,OAAQmC,EAAAA,QAAUG,KAAKD"}